(()=>{function S(){return new Promise(e=>{chrome.tabs.query({currentWindow:!0,active:!0}).then(s=>{chrome.cookies.getAll({url:s[0].url},n=>{let c=n.filter(o=>o.name==="SESSION"||o.name==="XSRF-TOKEN"||o.name==="PORTALWLJSESSIONID").reduce((o,r)=>(o[r.name]=r.value,o),{});e(c)})})})}function t(e){return document.getElementById(e)}function m(e,s,n){return fetch(e,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({sessionContent:s,xsrfContent:n})})}function a(e,s){let n=t(e);n&&navigator.clipboard.writeText(n.innerHTML).then(()=>{let c=document.getElementById("copied-message");c&&(c.innerHTML=s)})}let d="xsrf-token",u="session-token",y="portal-wlj-token",p="generated-command";document.addEventListener("DOMContentLoaded",function(){chrome.runtime.connect(),S().then(e=>{let s=t(d),n=t(u),c=t(p),o=t(y),r=e["XSRF-TOKEN"],i=e.SESSION,l=e.PORTALWLJSESSIONID;r?(s.textContent=r,t("xsrf-copy-btn")?.addEventListener("click",()=>a(d,"XSRF Token copied!"))):(s.textContent="N/A",t("xsrf-copy-btn").disabled=!0,t("xsrf-copy-btn").style.background="grey",t("xsrf-copy-btn").style.cursor="auto"),i?(n.textContent=i,t("session-copy-btn")?.addEventListener("click",()=>a(u,"SESSION Token copied!"))):(n.textContent="N/A",t("session-copy-btn").disabled=!0,t("session-copy-btn").style.background="grey",t("session-copy-btn").style.cursor="auto"),l?(o.textContent=l,t("portal-wlj-copy-btn")?.addEventListener("click",()=>{a(y,"PORTALWLJSESSIONID Token populated and copied!"),chrome.cookies.set({url:"http://localhost/",name:"PORTALWLJSESSIONID",value:l}).then()})):(o.textContent="N/A",t("portal-wlj-copy-btn").disabled=!0,t("portal-wlj-copy-btn").style.background="grey",t("portal-wlj-copy-btn").style.cursor="auto"),r&&i?(c.textContent=`./start-gateway-proxy.cmd ${i} ${r}`,t("command-copy-btn")?.addEventListener("click",()=>{a(p,"Command for gateway proxy copied!"),m("http://127.0.0.1:9595/",i,r).then()})):(c.textContent="N/A",t("command-copy-btn").disabled=!0,t("command-copy-btn").style.background="grey",t("command-copy-btn").style.cursor="auto")})},!1)})();
